<div class="admin-container">
  <div class="header">
    <h2>Admin - User Management</h2>
    <button (click)="navigateToDashboard()" class="btn-back">Back to Dashboard</button>
  </div>

  <div class="content">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner"></div>
      <p>Loading users...</p>
    </div>

    <!-- Add New User Form -->
    <div *ngIf="!isLoading" class="section">
      <h3>Add New User</h3>
      <form (ngSubmit)="addUser()" #userForm="ngForm" class="user-form">
        <div class="form-row">
          <div class="form-group">
            <label for="userId">User ID:</label>
            <input 
              id="userId"
              [(ngModel)]="newUser.userId" 
              name="userId" 
              required 
              class="form-control"
            />
          </div>
          
          <div class="form-group">
            <label for="name">Name:</label>
            <input 
              id="name"
              [(ngModel)]="newUser.name" 
              name="name" 
              required 
              class="form-control"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="password">Password:</label>
            <input 
              id="password"
              [(ngModel)]="newUser.password" 
              name="password" 
              type="password" 
              required 
              class="form-control"
            />
          </div>
          
          <div class="form-group">
            <label for="role">Role:</label>
            <select 
              id="role"
              [(ngModel)]="newUser.role" 
              name="role" 
              required 
              class="form-control"
            >
              <option value="General User">General User</option>
              <option value="Admin">Admin</option>
            </select>
          </div>
        </div>

        <button type="submit" [disabled]="!userForm.valid || isAdding" class="btn-add">
          <span *ngIf="isAdding">Adding...</span>
          <span *ngIf="!isAdding">Add User</span>
        </button>
      </form>
    </div>

    <!-- Users Table -->
    <div *ngIf="!isLoading" class="section">
      <h3>Existing Users</h3>
      <div class="table-controls">
        <label for="delay">API Delay (ms):</label>
        <input 
          id="delay"
          [(ngModel)]="delay" 
          type="number" 
          min="0" 
          max="10000" 
          class="delay-input"
        />
        <button (click)="refreshUsers()" [disabled]="isRefreshing" class="btn-refresh">
          <span *ngIf="isRefreshing">Refreshing...</span>
          <span *ngIf="!isRefreshing">Refresh</span>
        </button>
      </div>

      <div *ngIf="users.length > 0" class="users-table">
        <table>
          <thead>
            <tr>
              <th>User ID</th>
              <th>Name</th>
              <th>Role</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users">
              <td>{{user.userId}}</td>
              <td>{{user.name}}</td>
              <td>
                <span class="role-badge" [class.admin]="user.role === 'Admin'">
                  {{user.role}}
                </span>
              </td>
              <td>
                <button 
                  (click)="deleteUser(user.userId)" 
                  [disabled]="isDeleting === user.userId"
                  class="btn-delete"
                >
                  <span *ngIf="isDeleting === user.userId">Deleting...</span>
                  <span *ngIf="isDeleting !== user.userId">Delete</span>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="users.length === 0 && !isLoading" class="no-users">
        <p>No users found.</p>
      </div>
    </div>

    <!-- Error Messages -->
    <div *ngIf="error" class="error-message">
      {{error}}
    </div>
  </div>
</div>